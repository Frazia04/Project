CREATE TYPE t_background_job_type AS ENUM ('SEND_ACCOUNT_ACTIVATION_MAIL', 'SEND_PASSWORD_RESET_MAIL');

CREATE TABLE background_jobs
(
    id            BIGINT                                                             NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    type          t_background_job_type                                              NOT NULL,
    created       TIMESTAMP                                                          NOT NULL,
    next_attempt  TIMESTAMP                                                          NOT NULL,
    retry_count   SMALLINT DEFAULT 0                                                 NOT NULL,
    payload       BYTEA,

    CONSTRAINT pk__background_jobs PRIMARY KEY (id)
);
